#!/bin/sh

blob_arm=':arm:M::\x7fELF\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x28\x00:\xff\xff\xff\xff\xff\xff\xff\x00\xff\xff\xff\xff\xff\xff\xff\xff\xfe\xff\xff\xff'
blob_aarch64=':aarch64:M::\x7fELF\x02\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\xb7\x00:\xff\xff\xff\xff\xff\xff\xff\x00\xff\xff\xff\xff\xff\xff\xff\xff\xfe\xff\xff\xff'

binfmt="/proc/sys/fs/binfmt_misc"

for i in arm aarch64; do
    if [ -e $binfmt/$i ]; then
        echo -1 | tee $binfmt/$i &> /dev/null
    fi
done

echo "$blob_arm:/usr/bin/emu:" | tee $binfmt/register > /dev/null
echo "$blob_aarch64:/usr/bin/emu:CF" | tee $binfmt/register > /dev/null
